     # DAy 02 - Services & Tags

     ##  Ansible - Install and Enable Nginx


     ---
     - name: Install and start Nginx on Pathnex
     hosts: all
     become: yes


     tasks:
       - name: Install nginx
         yum:
	   name: nginx
	   state: present

       - name: Enable nginx
         service:
	   name: nginx
	   state: started
	   enabled: yes



      ##   Terraform - EC2 with tags (r5.2xlarge)

      provider "aws" {
        region = "us-east-1"
      }

      resource "aws_instance" "PathnexEC2" {
        ami           = "ami-0abcd1234abcd1234"
	instance_type = "r5.2xlage"

	tags = {
	  Name          = "sumit-pathnex-server"
	  Environment   = "Training"
	  owner         = "PathnexStudent"
	}
      }




      ##   Kubernetes - Deployment with 2 Replicas

      apiVersion: v1
      kind: Deployment
      metadata: 
        name: sumit-pathnex-deployment
      spec:
        replicas: 2
	selectors:
	  matchLabels:
	    app: sumit-pathnex-app
      template:
        metadata:
	  labels:
	    app: sumit-pathnex-app
	spec:
	  containers:
	    - name: app
	      image: nginx
	      ports:
	        - containers: 80
      

      ##   Shell Script - Disk Usage

      #!/bin/bash
      df -h





      # Maven Build
      ##   Jenkins pipeline - Maven Build



      pipeline {
          agenr any
	  tolls {
	      maven 'Maven-3.8.1
	      jdk 'JDK-17'
	  }
	  stages {
	      stage('Checkout') {
	          steps {
		      git url: 'https://github.com/sumit-pathnex/sample-java-app.git'}
		  }
	      }
	      stage('Test') {
	          steps {
		      sh 'mvn package'
		  }
	      }
	  }
      }

      ##  GitLab CI - Maven Build

      stages:
        - build
	- test
	- package


      maven-build:
        stage: build
	image: maven:3.8.1-jdk-17
	script:
	  - git clone https://github.com/sumit-pathnex/sample-java-app.git
	  - cd sample-java-app
	  - mvn clean compile

      maven-test:
        stage: test
	image:
	script:
	  - cd sample-java-app
      	  - mvn test

      maven-package:
        stage: package
	image: maven:3.8.1-jdk-17
	script:
	  - cd sample-java-app
	  - mvn package
